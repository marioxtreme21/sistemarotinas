<!-- src/main/webapp/resources/componentes/pesquisaInventoryUpdate.xhtml -->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <p:panel header="Disparo manual (Estoque)">
        <p:panelGrid columns="4" columnClasses="label,value,actions,actions" styleClass="panelPesquisa">

            <p:outputLabel for="loja" value="Loja:" />
            <p:selectOneMenu id="loja" value="#{inventoryUpdateBean.lojaId}"
                             style="min-width:260px" filter="true"
                             filterMatchMode="contains" showClear="true">
                <f:selectItem itemLabel="Todas as lojas" itemValue="#{null}" noSelectionOption="true" />
                <f:selectItems value="#{inventoryUpdateBean.lojasPermitidas}"
                               var="lz" itemValue="#{lz.lojaId}"
                               itemLabel="#{empty lz.nome ? lz.lojaId : lz.nome} - RMS #{lz.codLojaRms}" />
            </p:selectOneMenu>

            <p:commandButton id="btnExecInv" type="button"
                             value="Executar atualização" icon="pi pi-play"
                             actionListener="#{inventoryUpdateBean.executarAtualizacaoPorLoja}"
                             update=":formInv:msgs :formInv:resumo :formInv:tbl"
                             disabled="#{inventoryUpdateBean.executando}" />

            <p:commandButton id="btnReprocInv" type="button"
                             value="Reprocessar pendentes" icon="pi pi-refresh"
                             actionListener="#{inventoryUpdateBean.reprocessarPendentes}"
                             update=":formInv:msgs :formInv:resumo :formInv:tbl"
                             styleClass="ui-button-secondary"
                             disabled="#{inventoryUpdateBean.executando}" />
        </p:panelGrid>
    </p:panel>

    <p:spacer height="10" />

    <p:panel header="Pesquisa de Atualizações de Estoque">
        <p:panelGrid id="panelGridPesquisaIU" columns="4" cellpadding="5">

            <p:row>
                <p:outputLabel for="campoPesquisaIU" value="Campo:" />
                <p:selectOneMenu id="campoPesquisaIU"
                                 value="#{inventoryUpdateBean.campoSelecionado}" style="width: 100%;">
                    <f:selectItem itemLabel="Selecione um campo" itemValue="" />
                    <f:selectItems value="#{inventoryUpdateBean.camposPesquisa}" var="c"
                                   itemLabel="#{c.label}" itemValue="#{c.value}" />
                </p:selectOneMenu>
            </p:row>

            <p:row>
                <p:outputLabel for="condicaoPesquisaIU" value="Condição:" />
                <p:selectOneMenu id="condicaoPesquisaIU"
                                 value="#{inventoryUpdateBean.condicaoSelecionada}" style="width: 100%;">
                    <f:selectItem itemLabel="Selecione uma condição" itemValue="" />
                    <f:selectItem itemLabel="Igual" itemValue="equal" />
                    <f:selectItem itemLabel="Contém" itemValue="contains" />
                </p:selectOneMenu>
            </p:row>

            <p:row>
                <p:outputLabel for="valorPesquisaIU" value="Valor:" />
                <p:inputText id="valorPesquisaIU" value="#{inventoryUpdateBean.valorPesquisa}" style="width: 100%;" />
            </p:row>

            <p:row>
                <p:outputLabel />
                <p:commandButton id="btnPesquisarIU" value="Pesquisar" icon="pi pi-search"
                                 actionListener="#{inventoryUpdateBean.pesquisar}"
                                 update=":formInv:resumo :formInv:tbl"
                                 ajax="false" immediate="false"
                                 process="@this,panelGridPesquisaIU"
                                 styleClass="ui-button-primary" style="width: 100%;" />
            </p:row>

            <p:row>
                <p:outputLabel />
                <p:commandButton value="Limpar Filtros" icon="pi pi-times"
                                 actionListener="#{inventoryUpdateBean.limparFiltros}"
                                 update=":formInv:resumo :formInv:tbl"
                                 ajax="false" immediate="false"
                                 process="@this,panelGridPesquisaIU"
                                 styleClass="ui-button-secondary" style="width: 100%;" />
            </p:row>

        </p:panelGrid>
    </p:panel>

    <p:defaultCommand target="btnPesquisarIU" />
</ui:composition>
